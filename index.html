<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Trading Journal</title>
    <script>
        let SCRIPT_URL = localStorage.getItem('scriptUrl') || '';
        
        async function testConnection() {
            if (!SCRIPT_URL) return alert('Enter Script URL first');
            try {
                const res = await fetch(SCRIPT_URL + '?test=true');
                const data = await res.json();
                alert(data.success ? '‚úÖ Connected!' : '‚ùå Failed');
            } catch {
                alert('‚ùå Connection failed');
            }
        }
        
        async function addTrade() {
            const trade = {
                date: document.getElementById('date').value,
                time: document.getElementById('time').value,
                pair: document.getElementById('pair').value,
                session: document.getElementById('session').value,
                type: document.getElementById('type').value,
                result: document.getElementById('result').value,
                riskAmount: document.getElementById('risk').value,
                rewardAmount: document.getElementById('reward').value,
                notes: document.getElementById('notes').value
            };
            
            const res = await fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify({action: 'addTrade', trade})
            });
            
            const data = await res.json();
            alert(data.success ? '‚úÖ Trade saved!' : '‚ùå Error: ' + data.message);
        }
        
        function saveUrl() {
            const url = document.getElementById('scriptUrl').value;
            localStorage.setItem('scriptUrl', url);
            SCRIPT_URL = url;
            alert('‚úÖ URL saved');
        }
    </script>
</head>
<body>
    <h1>üìä Trading Journal</h1>
    
    <div>
        <h3>üîó Setup</h3>
        <input id="scriptUrl" placeholder="Google Script URL" style="width: 400px;">
        <button onclick="saveUrl()">Save URL</button>
        <button onclick="testConnection()">Test</button>
    </div>
    
    <div>
        <h3>‚ûï Add Trade</h3>
        <input id="date" type="date"> <input id="time" type="time"><br>
        <input id="pair" placeholder="Pair (EUR/USD)"><br>
        <select id="session">
            <option>Asian</option><option>European</option><option>American</option>
        </select>
        <select id="type"><option>Buy</option><option>Sell</option></select>
        <select id="result"><option>Win</option><option>Loss</option><option>Breakeven</option></select><br>
        <input id="risk" placeholder="Risk ($)"> <input id="reward" placeholder="Reward ($)"><br>
        <textarea id="notes" placeholder="Notes"></textarea><br>
        <button onclick="addTrade()">Save Trade</button>
    </div>
</body>
</html>
